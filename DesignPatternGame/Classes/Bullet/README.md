This part is refactored using the Decorator pattern.

This part is refactored using the Flyweight pattern.

This part is refactored using the Object Pool pattern.